(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{"57sp":function(e,t,a){e.exports={size:"size___2bCiy"}},"8Ke8":function(e,t,a){e.exports={position:"position___2wPWX"}},Do3O:function(e,t,a){e.exports={size:"size___30YAn"}},Vph0:function(e,t,a){e.exports={editor:"editor___1H_8Q",body:"body___11QME"}},dGND:function(e,t,a){e.exports={toolbar:"toolbar___2mZoo"}},dQd8:function(e,t,a){e.exports={picker:"picker___3EzcT",color:"color___2_SMr",bg:"bg___3MTnC",inner:"inner___2qgLY",popoup:"popoup___3xdiv",cover:"cover___1PNoi"}},f6bi:function(e,t,a){e.exports={horizontal:"horizontal___--bh1",hLabel:"hLabel___2MtfN",hChildren:"hChildren___1u01k",vertical:"vertical___2KHkK",vLabel:"vLabel___1htNz"}},jezX:function(e,t,a){e.exports={props:"props___15btK"}},m6Jv:function(e,t,a){e.exports={stage:"stage___2Jhd4",container:"container___3Jze6"}},mZnG:function(e,t,a){"use strict";a.r(t);var r=a("qIgq"),n=a.n(r),c=a("q1tI"),s=a.n(c),i=(a("5NDa"),a("5rEg")),o=(a("2qtc"),a("kLXV")),l=(a("y8nQ"),a("Vl3Y")),u=a("57sp"),d=a.n(u);l["a"].Item;function h(e){var t=e.visible,a=e.onCreate,r=e.onCancel,l=Object(c["useState"])(750),u=n()(l,2),h=u[0],p=u[1],v=Object(c["useState"])(750),b=n()(v,2),m=b[0],f=b[1],y=Object(c["useCallback"])(()=>{a({width:h,height:m})},[h,m]);return s.a.createElement(o["a"],{visible:t,title:"\u65b0\u5efa\u9879\u76ee",onOk:y,onCancel:r},s.a.createElement("div",{className:d.a.size},s.a.createElement(i["a"],{addonBefore:"\u5bbd\u5ea6",width:100,value:h,onChange:e=>{var t=e.target.value;return p(parseInt(t||"0"))}}),s.a.createElement(i["a"],{addonBefore:"\u9ad8\u5ea6",width:100,value:m,onChange:e=>{var t=e.target.value;return f(parseInt(t||"0"))}})))}var p=a("WFjJ"),v=a("f6bi"),b=a.n(v);function m(e){var t=e.children,a=e.label,r=e.className;return s.a.createElement("div",{className:b.a.vertical},s.a.createElement("div",{className:b.a.vLabel},a),s.a.createElement("div",{className:b.a.vChildren+" ".concat(r||"")},t))}var f=a("dQd8"),y=a.n(f),_=/^[rR][gG][bB]\(\s*[0-9]{1,3},\s*[0-9]{1,3},\s*[0-9]{1,3}\)$/,g=/^[rR][gG][bB][aA]\(\s*[0-9]{1,3},\s*[0-9]{1,3},\s*[0-9]{1,3},\s*[0-9]{1,3}\)$/,E=/^#[0-9a-fA-F]{3,8}$/;function S(e){return _.test(e)||g.test(e)||E.test(e)}function k(e){var t=e.attrs.bgcolor,a=e.sprite,r=Object(c["useState"])(t),o=n()(r,2),l=o[0],u=o[1];Object(c["useEffect"])(()=>{u(t)},[t]);var d=Object(c["useState"])(!1),h=n()(d,2),v=h[0],b=h[1],f=Object(c["useCallback"])(()=>b(!0),[]),_=Object(c["useCallback"])(()=>b(!1),[]),g=Object(c["useCallback"])(e=>{if(1===e.rgb.a)e=e.hex;else if(0===e.rgb.a)e="";else{var t=e.rgb,r=t.r,n=t.g,c=t.b,s=t.a;e="rgba(".concat(r,",").concat(n,",").concat(c,",").concat(s,")")}u(e),a.attr({bgcolor:e})},[]),E=Object(c["useCallback"])(e=>{var t=e.target.value;u(t),console.log(t,S(t)),S(t)&&a.attr({bgcolor:t})},[]);return s.a.createElement(m,{label:"\u80cc\u666f\u8272"},s.a.createElement("div",{className:y.a.picker},s.a.createElement(i["a"],{value:l,onChange:E,addonAfter:s.a.createElement("div",{onClick:f,className:y.a.color},s.a.createElement("div",{className:y.a.bg}),s.a.createElement("div",{className:y.a.inner,style:{background:l}}))}),v&&s.a.createElement("div",{className:y.a.popoup},s.a.createElement("div",{className:y.a.cover,onClick:_}),s.a.createElement(p["SketchPicker"],{onChange:g,color:l}))))}var C=a("n44d");class j{constructor(e){this.layer=e,this.selector=new C["c"]({dashOffset:10,id:"selector",zIndex:30,border:{width:1,color:"red",style:"dashed"}}),this.isMoving=!1,this.movingPosition={x:0,y:0},this.onKeydown=(e=>{if(this.currentSprite){var t=this.currentSprite.attr(),a=t.x,r=t.y;switch(e.code){case"ArrowRight":this.currentSprite.attr({x:e.altKey?a+10:a+1});break;case"ArrowLeft":this.currentSprite.attr({x:e.altKey?a-10:a-1});break;case"ArrowUp":this.currentSprite.attr({y:e.altKey?r-10:r-1});break;case"ArrowDown":this.currentSprite.attr({y:e.altKey?r+10:r+1});break}this.onSelectHandler&&this.onSelectHandler(this.currentSprite),this.strokeSelected(),e.stopPropagation(),e.preventDefault()}}),this.onKeyup=(e=>{}),this.selector.animate([{dashOffset:0},{dashOffset:1e3}],{duration:1e5,direction:"alternate",iterations:1/0}),this.layer.on("click",e=>{var t=this.findTarget(e);t?(this.currentSprite=t,this.strokeSelected(),this.onSelectHandler&&this.onSelectHandler(t)):(this.hideSelector(),this.onSelectHandler&&this.onSelectHandler())}),this.layer.on("mousedown",e=>{var t=this.findTarget(e);t&&this.currentSprite===t&&(this.isMoving=!0,this.movingPosition={x:e.x,y:e.y})}),this.layer.on("mousemove",e=>{if(this.isMoving&&this.currentSprite){var t={x:e.x,y:e.y},a=this.movingPosition.x-t.x,r=this.movingPosition.y-t.y;this.currentSprite.attr({pos:[this.currentSprite.xy[0]-a,this.currentSprite.xy[1]-r]}),this.strokeSelected(),this.movingPosition=t}}),this.layer.on("mouseup",e=>{this.isMoving=!1}),this.layer.on("keydown",e=>{console.log(e)})}findTarget(e){var t=e.target;return t===this.selector&&(t=e.targetSprites.find(e=>e!==this.selector)),t&&"layer"!==t.nodeType?t:null}hideSelector(){this.selector.attr({size:[0,0],pos:[-1e3,-1e3]}),this.currentSprite=void 0}strokeSelected(){var e=this.currentSprite;if(e){if(e===this.selector)return;var t=e.clientSize,a=e.xy;this.selector.attr({width:t[0]-1,height:t[1]-1,pos:a})}}createProject(e){var t=e.width,a=e.height;w.resolution=[t,a],w.viewport=[t,a],this.hideSelector(),this.layer.clear(),this.layer.append(this.selector),this.onSelectHandler&&this.onSelectHandler()}setSelectHandler(e){this.onSelectHandler=e}append(e){this.layer.append(e)}}var w,O,x=a("m6Jv"),N=a.n(x);function z(e){var t=e.onSelect,a=Object(c["useRef"])(null);return Object(c["useEffect"])(()=>{var e=a.current;return w=new C["b"](e,{resolution:[0,0],viewport:[0,0]}),O=new j(w.layer()),O.setSelectHandler(t),O.createProject({width:500,height:500}),e.addEventListener("keydown",O.onKeydown),e.addEventListener("keyup",O.onKeyup),()=>{e.removeEventListener("keydown",O.onKeydown),e.removeEventListener("keyup",O.onKeyup)}},[]),s.a.createElement("div",{className:N.a.stage},s.a.createElement("div",{className:N.a.container,tabIndex:-1,ref:a}))}var K=a("8Ke8"),P=a.n(K);function I(e){var t=e.attrs,a=e.sprite,r=Object(c["useState"])(t.x),o=n()(r,2),l=o[0],u=o[1],d=Object(c["useState"])(t.y),h=n()(d,2),p=h[0],v=h[1];Object(c["useEffect"])(()=>{u(t.x),v(t.y)},[t]);var b=Object(c["useCallback"])(e=>{var t=e.target.value,r=parseInt(t)||0;u(r),a.attr("x",r),O.strokeSelected()},[]),f=Object(c["useCallback"])(e=>{var t=e.target.value,r=parseInt(t)||0;v(r),a.attr("y",r),O.strokeSelected()},[]);return s.a.createElement(m,{label:"\u4f4d\u7f6e",className:P.a.position},s.a.createElement(i["a"],{addonBefore:"X",onChange:b,value:l}),s.a.createElement(i["a"],{addonBefore:"Y",onChange:f,value:p}))}var H=a("Do3O"),L=a.n(H);function B(e){var t=e.attrs,a=e.sprite,r=Object(c["useState"])(t.width),o=n()(r,2),l=o[0],u=o[1],d=Object(c["useState"])(t.height),h=n()(d,2),p=h[0],v=h[1];Object(c["useEffect"])(()=>{u(t.width),v(t.height)},[t]);var b=Object(c["useCallback"])(e=>{var t=e.target.value,r=parseInt(t)||0;u(r),a.attr("width",r),O.strokeSelected()},[]),f=Object(c["useCallback"])(e=>{var t=e.target.value,r=parseInt(t)||0;v(r),a.attr("height",r),O.strokeSelected()},[]);return s.a.createElement(m,{label:"\u5927\u5c0f",className:L.a.size},s.a.createElement(i["a"],{addonBefore:"\u5bbd",onChange:b,value:l}),s.a.createElement(i["a"],{addonBefore:"\u9ad8",onChange:f,value:p}))}var M=a("jezX"),A=a.n(M),q=[k,I,B];function D(e){var t=e.attrs,a=e.sprite;return s.a.createElement("div",{className:A.a.props},t&&a&&q.map((e,r)=>{return s.a.createElement(e,{key:r,attrs:t,sprite:a})}))}a("Pwec");var J=a("CtXQ"),Q=a("qF86"),T=a.n(Q),G={Sprite:{icon:"picture",create:()=>{return new C["c"]({size:[100,100],bgcolor:"red"})}},Label:{icon:"font-colors",create:()=>{return new C["a"]({text:"\u6587\u672c"})}}};function X(e){return s.a.createElement("div",{className:T.a.libaray},s.a.createElement("ul",null,Object.keys(G).map(t=>{var a=G[t];return s.a.createElement("li",{key:t,onClick:()=>{e.onCreateSprite(a.create())}},s.a.createElement(J["a"],{type:a.icon}),s.a.createElement("span",null,t))})))}a("lUTK");var F=a("BvKs"),R=a("dGND"),V=a.n(R),Y=F["a"].SubMenu;function $(e){var t=e.onOpenCreateProject,a=Object(c["useState"])([]),r=n()(a,2),i=r[0],o=(r[1],Object(c["useCallback"])(e=>{console.log(e);var a=e.key;"new"===a&&t()},[]));return s.a.createElement("div",{className:V.a.toolbar},s.a.createElement(F["a"],{onClick:o,selectedKeys:i,mode:"horizontal"},s.a.createElement(Y,{title:s.a.createElement("span",{className:"submenu-title-wrapper"},s.a.createElement(J["a"],{type:"file"}),"\u9879\u76ee")},s.a.createElement(F["a"].Item,{key:"new"},s.a.createElement(J["a"],{type:"file-add"}),"\u65b0\u5efa"),s.a.createElement(F["a"].Item,{key:"open"},s.a.createElement(J["a"],{type:"folder-open"}),"\u6253\u5f00")),s.a.createElement(F["a"].Item,{key:"alipay"},s.a.createElement("a",{href:"#",target:"_blank",rel:"noopener noreferrer"},"\u5e2e\u52a9"))))}var U=a("Vph0"),W=a.n(U);function Z(){var e=Object(c["useState"])(),t=n()(e,2),a=t[0],r=t[1],i=Object(c["useState"])(),o=n()(i,2),l=o[0],u=o[1],d=Object(c["useState"])(!1),p=n()(d,2),v=p[0],b=p[1],m=Object(c["useCallback"])(()=>b(!0),[]),f=Object(c["useCallback"])(()=>b(!1),[]),y=Object(c["useCallback"])(e=>{O.append(e)},[]),_=Object(c["useCallback"])(e=>{b(!1),O.createProject(e)},[]),g=Object(c["useCallback"])(e=>{r(e),e&&u(e.attr())},[]);return s.a.createElement("div",{className:W.a.editor},s.a.createElement($,{onOpenCreateProject:m}),s.a.createElement(h,{visible:v,onCreate:_,onCancel:f}),s.a.createElement("div",{className:W.a.body},s.a.createElement(X,{onCreateSprite:y}),s.a.createElement(z,{onSelect:g}),s.a.createElement(D,{sprite:a,attrs:l})))}a.d(t,"default",function(){return Z})},qF86:function(e,t,a){e.exports={libaray:"libaray___zQtFG"}}}]);